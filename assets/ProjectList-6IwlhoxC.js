import{b as u,j as e,r as p}from"./index-DV3HGm6M.js";import{G as J,N as z,a as g,E,c as K,o as h,D as y}from"./NumberInput-Bl50LkCo.js";import{I as O}from"./Input-esSgYffC.js";import{M as b}from"./index-l65SKHf7.js";import{B as x}from"./button-Cvk8VxbG.js";import{globalMessage as C}from"./GlobalMessage-BFtSe0qv.js";import{D as F,A as Z,P as q}from"./Delete-CVWdzrjG.js";import{I as Q}from"./index-by9GQrEU.js";import{I as S}from"./index-BZlaEHGr.js";const U=Q("copy",!0,function(t){return u.createElement("svg",{width:t.size,height:t.size,viewBox:"0 0 48 48",fill:"none"},u.createElement("path",{d:"M13 12.4316V7.8125C13 6.2592 14.2592 5 15.8125 5H40.1875C41.7408 5 43 6.2592 43 7.8125V32.1875C43 33.7408 41.7408 35 40.1875 35H35.5163",stroke:t.colors[0],strokeWidth:t.strokeWidth,strokeLinecap:t.strokeLinecap,strokeLinejoin:t.strokeLinejoin}),u.createElement("path",{d:"M32.1875 13H7.8125C6.2592 13 5 14.2592 5 15.8125V40.1875C5 41.7408 6.2592 43 7.8125 43H32.1875C33.7408 43 35 41.7408 35 40.1875V15.8125C35 14.2592 33.7408 13 32.1875 13Z",fill:t.colors[1],stroke:t.colors[0],strokeWidth:t.strokeWidth,strokeLinejoin:t.strokeLinejoin}))}),X="/assets/default-snapshot-IoTojipW.jpg",Y=t=>{const s={name:"未命名项目",des:"",width:1920,height:1080},r=a=>{a.preventDefault();const{onOk:d}=t;d&&d(s)},i=()=>{const{onCancel:a}=t;a&&a()},{visible:l=!1}=t;return e.jsxs(b,{title:"新建大屏",open:l,className:"add-new-screen-dialog",onCancel:i,footer:[e.jsx(x,{type:"primary",onClick:r,children:"创建"}),e.jsx(x,{onClick:i,children:"取消"})],children:[e.jsx("div",{className:"lc-add-new-screen",children:e.jsxs(J,{gridGap:"15px",columns:2,children:[e.jsx(O,{label:"名称",defaultValue:s.name,onChange:a=>s.name=a}),e.jsx(O,{label:"描述",onChange:a=>s.des=a}),e.jsx(z,{label:"宽度",min:300,defaultValue:s.width,onChange:a=>s.width=Number(a)}),e.jsx(z,{label:"高度",min:300,defaultValue:s.height,onChange:a=>s.height=Number(a)})]})}),e.jsx("div",{className:"add-new-screen-explain",children:e.jsx("p",{children:"说明：1、名称不超过20字，描述不超过60字。2、宽度必须≥500，高度必须≥300"})})]})},ee=p.memo(t=>{const{onOk:s,onCancel:r,visible:i}=t;return e.jsx(b,{title:"删除确认",open:i,onCancel:r,onOk:s,width:350,footer:[e.jsx(x,{type:"primary",onClick:s,children:"确认"}),e.jsx(x,{onClick:r,children:"取消"})],children:e.jsx("div",{style:{color:"#aeaeae",padding:10},children:"确定要删除该项目吗？"})})}),se=t=>{const{onOk:s,onCancel:r,visible:i}=t,l=a=>{a.preventDefault(),s()};return e.jsx(b,{title:"克隆项目",open:i,onCancel:r,onOk:l,width:350,footer:[e.jsx(x,{type:"primary",onClick:l,children:"确认"}),e.jsx(x,{onClick:r,children:"取消"})],children:e.jsx("div",{style:{color:"#a7a7a7",padding:10},children:"确认克隆项目吗？"})})};function ne(t){const{cover:s,id:r,saveType:i,doOperate:l}=t,[a,d]=p.useState(!1),[j,v]=p.useState(t.name),f=()=>{if(j!==t.name){const n={id:r,name:j};h[i].updateProject(n)}};return e.jsxs("div",{className:"project-list-item",children:[e.jsx("div",{className:"project-item-cover",style:{backgroundImage:`url(${s})`},children:e.jsxs("div",{className:"operate-icon-list",children:[e.jsx("div",{className:"operate-icon",children:e.jsx(g,{content:"编辑项目",children:e.jsx(E,{onClick:()=>l(r,"edit")})})}),e.jsx("div",{className:"operate-icon",children:e.jsx(g,{content:"预览项目",children:e.jsx(K,{onClick:()=>l(r,"show")})})}),e.jsx("div",{className:"operate-icon",children:e.jsx(g,{content:"删除项目",children:e.jsx(F,{onClick:()=>l(r,"del")})})}),e.jsx("div",{className:"operate-icon",children:e.jsx(g,{content:"复制项目",children:e.jsx(U,{onClick:()=>l(r,"clone")})})})]})}),e.jsxs("div",{className:"project-item-content",children:[e.jsx("div",{className:"project-name",children:a?e.jsx("div",{className:"project-rename-input",children:e.jsx(S,{autoFocus:!0,size:"small",value:j,onBlur:()=>{f(),d(!1)},onKeyDown:n=>{n.key==="Enter"&&(f(),d(!1))},onChange:n=>v(n.target.value)})}):e.jsx("div",{className:"project-name-content",children:j})}),e.jsx("div",{className:"rename-icon",onClick:()=>d(!0),children:a||e.jsx(g,{content:"重命名",children:e.jsx(E,{})})})]})]})}const{Search:te}=S,he=p.memo(t=>{const{saveType:s}=t,[r,i]=u.useState(!1),[l,a]=u.useState(!1),[d,j]=u.useState(!1),v=p.useRef(""),f=p.useRef(""),[n,N]=u.useState({records:[],total:0,current:1,size:24}),k=(o,c,m)=>{h[s].getProjectInfoPageList({current:o,size:c,searchValue:m}).then(w=>N(w))},L=()=>i(!r),$=o=>{const{name:c,des:m,width:w,height:G}=o,_={name:c,des:m,saveType:s,dataJson:JSON.stringify({canvasManager:{width:w,height:G}})};h[s].createProject(_).then(D=>{var I;D===""?(I=C.messageApi)==null||I.error("创建失败"):(i(!1),window.open(`/designer?id=${D}&saveType=${s}&mode=${y.EDIT}`,"_blank"),k(n.current,n.size))})},V=()=>i(!1),M=(o,c)=>{switch(c){case"edit":window.open(`/designer?id=${o}&saveType=${s}&mode=${y.EDIT}`,"_blank");break;case"show":window.open(`/view?id=${o}&saveType=${s}&mode=${y.VIEW}`,"_blank");break;case"del":v.current=o,a(!0);break;case"clone":f.current=o,j(!0);break}},R=()=>a(!1),T=()=>{h[s].copyProject(f.current).then(o=>{var c,m;o!==""?(j(!1),k(n.current,n.size),(c=C.messageApi)==null||c.success("克隆成功")):(m=C.messageApi)==null||m.error("克隆失败")})},A=()=>j(!1),W=()=>{h[s].deleteProject(v.current).then(o=>{var c;o?(a(!1),k(n.current,n.size)):(c=C.messageApi)==null||c.error("删除失败")})},H=(o,c)=>{h[s].getProjectInfoPageList({current:o,size:c}).then(m=>N(m))},B=o=>{o.key==="Enter"&&P(o.target.value)},P=o=>{h[s].getProjectInfoPageList({current:n.current,size:n.size,searchValue:o}).then(c=>N(c))};return p.useEffect(()=>{k(n.current,n.size)},[]),e.jsxs("div",{className:"project-list-container",children:[e.jsxs("div",{className:"project-list-header",children:[e.jsxs("div",{className:"project-list-header-left",children:[e.jsx(te,{placeholder:"搜索项目",size:"middle",className:"project-list-search",onKeyDown:B,onSearch:P,style:{width:350}}),e.jsxs(x,{size:"middle",type:"primary",onClick:L,children:[e.jsx(Z,{style:{position:"relative",top:3,marginRight:3}}),"新增"]})]}),e.jsx("div",{className:"project-list-header-right"})]}),e.jsx("div",{className:"project-list",children:n&&n.records.map(o=>e.jsx(ne,{id:o.id,name:o.name,cover:o.cover||X,saveType:s,doOperate:M},o.id))}),e.jsx(q,{rootClassName:"project-list-page",defaultCurrent:n==null?void 0:n.current,pageSize:n==null?void 0:n.size,total:n==null?void 0:n.total,onChange:H}),e.jsx(Y,{onOk:$,onCancel:V,visible:r}),e.jsx(ee,{visible:l,onOk:W,onCancel:R}),e.jsx(se,{onOk:()=>T(),onCancel:A,visible:d})]})});export{he as P};
